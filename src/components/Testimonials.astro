---
// ...existing code...
const testimonials = [
  {
    id: 'story-1',
    clientName: 'Jos√© Ramiro',
    projectType: 'Remodelaci√≥n de Casa',
    content: {
      text: "La mejor prueba de nuestro trabajo son nuestros clientes satisfechos.üé§ Jos√© Ramiro confi√≥ en Arquitectura y Construcci√≥n S.A.S. y hoy nos comparte su experiencia. Cada proyecto que realizamos es un compromiso con la calidad, la innovaci√≥n y la satisfacci√≥n de nuestros clientes. üèóÔ∏èüè†",
      video: 'testimonio-1.mp4'
    }
  },
  {
    id: 'story-2',
    clientName: 'Sergio Yamid Herrera',
    projectType: 'Remodelaci√≥n de Casa',
    content: {
      text: "üî∑ La mejor garant√≠a es la satisfacci√≥n de nuestros clientes üî∑ Escucha el testimonio de Sergio Yamid Herrera, quien confi√≥ en AC Arquitectura y Construcci√≥n S.A.S para su proyecto. üèóÔ∏è‚ú®",
      video: 'testimonio-2.mp4'
    }
  },
  // {
  //   id: 'story-3',
  //   clientName: 'Restaurant La Plaza',
  //   projectType: 'Dise√±o de Interiores',
  //   content: {
  //     text: "La renovaci√≥n de nuestro restaurante fue todo un √©xito. RemodelPro entendi√≥ perfectamente nuestra visi√≥n y la ejecut√≥ de manera brillante.",
  //     video: '/testimonials/plaza/testimonial.mp4'
  //   }
  // }
];
---

<section class="py-20 bg-neutral">
  <div class="container mx-auto px-4">
    <!-- Section Title -->
    <div class="text-center mb-12" data-aos="fade-up">
      <h2 class="text-4xl font-bold text-primary mb-4">Testimonios</h2>
      <p class="text-gray-600 max-w-2xl mx-auto">
        Descubre las historias de √©xito de nuestros clientes satisfechos
      </p>
    </div>

    <!-- Instagram-style Stories -->
    <div class="max-w-screen-lg mx-auto" data-aos="fade-up">
      <!-- Stories Container -->
      <div class="flex justify-center">
        <div class="grid grid-flow-col auto-cols-max gap-4 md:gap-8 overflow-x-auto py-4 px-4 snap-x scrollbar-hide">
          {testimonials.map((story) => (
            <div class="snap-start">
              <button 
                class="story-trigger group focus:outline-none"
                data-story-id={story.id}
              >
                <!-- Story Circle -->
                <div class="w-16 h-16 md:w-24 md:h-24 rounded-full bg-gradient-to-tr from-yellow-400 via-red-500 to-purple-500 p-0.5 cursor-pointer transition-transform duration-300 hover:scale-105">
                  <div class="w-full h-full rounded-full border-2 border-white p-0.5 bg-white">
                    <img 
                      src={story.thumbnail} 
                      alt={story.clientName}
                      class="w-full h-full rounded-full object-cover"
                      loading="lazy"
                    />
                  </div>
                </div>
                <!-- Story Name -->
                <p class="text-center text-sm mt-2 text-gray-700 font-medium truncate max-w-[100px]">
                  {story.clientName}
                </p>
              </button>
            </div>
          ))}
        </div>
      </div>
    </div>
  </div>

  <!-- Story Modal -->
  <div id="story-modal" class="fixed inset-0 bg-black/95 z-50 hidden">
    <div class="relative w-full h-full flex items-center justify-center">
      <!-- Close Button -->
      <button 
        id="close-story" 
        class="absolute top-4 right-4 md:top-8 md:right-8 text-white hover:text-primary z-10 p-2 transition-colors"
        aria-label="Close story"
      >
        <svg class="w-8 h-8" fill="none" stroke="black" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>

      <!-- Story Content Container -->
      <div class="w-full max-w-4xl mx-auto h-full md:h-auto md:max-h-[85vh] bg-white rounded-none md:rounded-xl overflow-hidden">
        <div id="story-content" class="h-full md:h-auto overflow-y-auto">
          <!-- Content will be dynamically inserted here -->
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  /* Distribuci√≥n para m√≥vil (predeterminado) */
  #story-content {
    display: flex;
    flex-direction: column;
  }
  .video-container {
  position: relative;
  padding-bottom: 56.25%; /* Mant√©n la relaci√≥n de aspecto 16:9 */
  height: 0;
  overflow: hidden;
  max-width: 100%;
  background: #000;
  border-radius: 12px; /* Bordes redondeados */
  margin: 0 auto; /* Centra el contenedor */
}

/* Ajusta el video para que ocupe todo el contenedor */
.video-container video {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover; /* Asegura que el video cubra el contenedor sin distorsi√≥n */
}
</style>

<script>
const testimonials = {
  'story-1': {
    clientName: 'Jos√© Ramiro',
    projectType: 'Remodelaci√≥n de Casa',
    content: {
      text: "La mejor prueba de nuestro trabajo son nuestros clientes satisfechosüé§ Jos√© Ramiro confi√≥ en Arquitectura y Construcci√≥n S.A.S. y hoy nos comparte su experiencia. Cada proyecto que realizamos es un compromiso con la calidad, la innovaci√≥n y la satisfacci√≥n de nuestros clientes. üèóÔ∏èüè†",
      video: '/testimonio-1.mp4'
    }
  },
  'story-2': {
    clientName: 'Sergio Yamid Herrera',
    projectType: 'Remodelaci√≥n de Casa',
    content: {
      text: "üî∑ La mejor garant√≠a es la satisfacci√≥n de nuestros clientes üî∑ Escucha el testimonio de Sergio Yamid Herrera, quien confi√≥ en AC Arquitectura y Construcci√≥n S.A.S para su proyecto. üèóÔ∏è‚ú®",
      video: 'testimonio-2.mp4'
    }
  },
  // 'story-3': {
  //   clientName: 'Restaurant La Plaza',
  //   projectType: 'Dise√±o de Interiores',
  //   content: {
  //     text: "La renovaci√≥n de nuestro restaurante fue todo un √©xito. RemodelPro entendi√≥ perfectamente nuestra visi√≥n y la ejecut√≥ de manera brillante.",
  //     video: '/testimonials/plaza/testimonial.mp4'
  //   }
  // }
};

document.addEventListener('DOMContentLoaded', () => {
  const modal = document.getElementById('story-modal');
  const storyContent = document.getElementById('story-content');
  const closeButton = document.getElementById('close-story');
  const storyTriggers = document.querySelectorAll('.story-trigger');

  function showStory(storyId) {
    const story = testimonials[storyId];
    if (!story) return;

    const content = `
      <div id="story-content" class="p-4 md:p-8 flex flex-col md:flex-row bg-gray-100 rounded-lg shadow-lg">
        <!-- Contenido textual -->
        <div class="md:w-1/2 w-full flex items-center justify-center p-4 md:p-6 text-center md:text-left">
          <div class="w-full">
            <div class="flex items-center space-x-4 mb-4">
              <div class="w-12 h-12 rounded-full overflow-hidden">
                <img 
                  src="/testimonials/${storyId}-thumb.jpg" 
                  alt="${story.clientName}"
                  class="w-full h-full object-cover"
                  loading="lazy"
                />
              </div>
              <div>
                <h3 class="text-xl font-bold text-primary">${story.clientName}</h3>
                <p class="text-gray-600">${story.projectType}</p>
              </div>
            </div>
            <p class="text-gray-700 text-base md:text-lg leading-relaxed">
              ${story.content.text}
            </p>
          </div>
        </div>

        <!-- Contenido multimedia -->
        <div class="md:w-1/2 w-full flex items-center justify-center p-4 md:p-6 rounded-lg"> 
  <div class="w-full">
    ${story.content.video ? `
      <div class="video-container"> 
        <video controls playsinline autoplay muted loop class="w-full h-auto md:w-3/4 rounded-lg "> 
          <source src="${story.content.video}" type="video/mp4">
          Your browser does not support the video tag.
        </video>
      </div>
    ` : ''}
  </div>
</div>
        </div>
      </div>
    `;

    storyContent.innerHTML = content;
    modal.classList.remove('hidden');
    document.body.style.overflow = 'hidden';
  }

  storyTriggers.forEach(trigger => {
    trigger.addEventListener('click', () => {
      const storyId = trigger.dataset.storyId;
      showStory(storyId);
    });
  });

  function closeModal() {
    modal.classList.add('hidden');
    document.body.style.overflow = '';
  }

  closeButton.addEventListener('click', closeModal);

  // Close modal when clicking outside
  modal.addEventListener('click', (e) => {
    if (e.target === modal) {
      closeModal();
    }
  });

  // Close modal with Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && !modal.classList.contains('hidden')) {
      closeModal();
    }
  });
});
</script>