---
import Layout from '../layouts/Layout.astro';
import WhatsAppButton from '../components/WhatsAppButton.astro';

const title = "Contacto - AC Arquitectura";
const description = "Póngase en contacto con AC Arquitectura para consultas personalizadas sobre remodelaciones y construcciones en Cali.";
const url = "https://www.acarquitectura.com.co/contact";
const image = "https://opengraph.b-cdn.net/production/images/e0540ec3-9987-4226-b126-db660c9c66b7.svg?token=V8LpduB_Z3vP5T3yB26RGfZoguaeB_hkrPJ_Qc8xqrw&height=130&width=300&expires=33275810993";
---

<Layout title={title} description={description} url={url} image={image}>
  <section id="contact" class="py-20 bg-neutral relative overflow-hidden">
    <!-- Efecto de partículas de fondo -->
    <div class="absolute inset-0 z-0 opacity-5">
      <div class="absolute w-64 h-64 bg-primary rounded-full -top-32 -left-32 animate-pulse"></div>
      <div class="absolute w-48 h-48 bg-secondary rounded-full -bottom-24 -right-24 animate-spin-slow"></div>
    </div>

    <div class="container mx-auto px-4 relative z-10">
      <!-- Encabezado con animación -->
      <div class="text-center mb-16" data-aos="zoom-in">
        <h1 class="text-4xl md:text-5xl font-bold mb-4">
          <span class="bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent animate-gradient">
            Contáctenos
          </span>
        </h1>
        <p class="text-gray-600 max-w-2xl mx-auto animate-fade-in-up" data-aos="fade-up" data-aos-delay="200">
          Póngase en contacto con nosotros para una consulta personalizada vía correo
        </p>
      </div>

      <!-- Formulario con animaciones escalonadas -->
      <div class="max-w-2xl mx-auto" data-aos="fade-up" data-aos-delay="300">
        <form id="contact-form" class="space-y-6 bg-white/95 backdrop-blur-sm p-8 rounded-xl shadow-2xl hover:shadow-3xl transition-shadow">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div data-aos="fade-right" data-aos-delay="400">
              <label for="name" class="block text-gray-700 mb-2 flex items-center">
                <i class="fas fa-user text-primary mr-2 animate-bounce"></i>
                Nombre
              </label>
              <input
                type="text"
                id="name"
                name="name"
                required
                class="form-input w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-secondary focus:ring-4 focus:ring-secondary/20 outline-none transition-all"
              />
            </div>
            
            <div data-aos="fade-left" data-aos-delay="400">
              <label for="number" class="block text-gray-700 mb-2 flex items-center">
                <i class="fas fa-phone text-primary mr-2 animate-pulse"></i>
                Teléfono
              </label>
              <input
                type="number"
                id="number"
                name="number"
                required
                class="form-input w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-secondary focus:ring-4 focus:ring-secondary/20 outline-none transition-all"
              />
            </div>
          </div>

          <div data-aos="fade-up" data-aos-delay="500">
            <label for="email" class="block text-gray-700 mb-2 flex items-center">
              <i class="fas fa-envelope text-primary mr-2 animate-float"></i>
              Correo
            </label>
            <div class="relative">
              <input
                type="email"
                id="email"
                name="email"
                required
                class="form-input w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-secondary focus:ring-4 focus:ring-secondary/20 outline-none transition-all peer"
              />
              <div class="validation-icon hidden absolute right-4 top-1/2 -translate-y-1/2 text-red-500">
                <i class="fas fa-exclamation-circle animate-shake"></i>
              </div>
            </div>
          </div>

          <div data-aos="fade-up" data-aos-delay="600">
            <label for="service" class="block text-gray-700 mb-2 flex items-center">
              <i class="fas fa-cogs text-primary mr-2 animate-spin-slow"></i>
              Servicio
            </label>
            <div class="relative">
              <select
                id="service"
                name="service"
                required
                class="form-input w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-secondary focus:ring-4 focus:ring-secondary/20 outline-none transition-all appearance-none"
              >
              <option value="">Seleccione un servicio</option>
              <option value="basic">Servicio Básico</option>
              <option value="enhanced">Servicio Plus</option>
              <option value="premium">Servicio Premium</option>
              <option value="custom">Proyecto Personalizado</option>
              </select>
              <i class="fas fa-chevron-down absolute right-4 top-1/2 -translate-y-1/2 text-primary animate-bounce"></i>
            </div>
          </div>

          <div data-aos="fade-up" data-aos-delay="700">
            <label for="message" class="block text-gray-700 mb-2 flex items-center">
              <i class="fas fa-comment-dots text-primary mr-2 animate-tada"></i>
              Mensaje
            </label>
            <textarea
              id="message"
              name="message"
              rows="4"
              required
              class="form-input w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-secondary focus:ring-4 focus:ring-secondary/20 outline-none transition-all resize-none hover:resize-y"
            ></textarea>
          </div>

          <button
            type="submit"
            class="w-full bg-gradient-to-r from-primary to-secondary hover:from-secondary hover:to-primary text-white font-bold py-4 px-6 rounded-lg transition-all transform hover:scale-[1.02] hover:shadow-xl relative overflow-hidden"
            data-aos-delay="800"
          >
            <span class="relative z-10">Enviar mensaje</span>
            <div class="absolute inset-0 bg-white/10 opacity-0 hover:opacity-20 transition-opacity"></div>
          </button>
        </form>

        <p class="text-gray-600 mt-6 text-center" data-aos="fade-up" data-aos-delay="900">
          Si no recibe una respuesta, comuníquese mediante
          <a href="https://www.facebook.com/ac.arquitecurayconstruccion" 
             class="social-link animate-underline" 
             target="_blank">
            Facebook
          </a> o 
          <a href="https://www.instagram.com/ac_arquitecturayconstrucciones/" 
             class="social-link animate-underline" 
             target="_blank">
            Instagram
          </a>.
        </p>
      </div>
    </div>
  </section>

  <WhatsAppButton />

  <style is:global>
    /* Animaciones personalizadas */
    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    @keyframes fade-in-up {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes underline {
      from { width: 0; }
      to { width: 100%; }
    }

    .animate-gradient {
      background-size: 200% auto;
      animation: gradient 3s linear infinite;
    }

    .animate-fade-in-up {
      animation: fade-in-up 0.8s ease-out forwards;
    }

    .animate-underline {
      position: relative;
      padding-bottom: 2px;
    }

    .animate-underline::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 0;
      height: 2px;
      background: currentColor;
      transition: width 0.3s ease;
    }

    .animate-underline:hover::after {
      width: 100%;
    }

    .form-input:focus {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(242, 116, 5, 0.15);
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }

    .animate-shake {
      animation: shake 0.4s ease-in-out;
    }

    @keyframes spin-slow {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .animate-spin-slow {
      animation: spin-slow 8s linear infinite;
    }
  </style>

<script>
  // Validación mejorada con animaciones
  function validateEmail(email) {
      const re = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
      const validationIcon = document.querySelector('#email + .validation-icon');
      
      if (!re.test(String(email).toLowerCase())) {
        validationIcon.classList.remove('hidden');
        document.getElementById('email').classList.add('border-red-500', 'animate-shake');
      } else {
        validationIcon.classList.add('hidden');
        document.getElementById('email').classList.remove('border-red-500');
      }
    }
    document.getElementById('contact-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    const submitBtn = e.target.querySelector('button[type="submit"]');
    
    submitBtn.innerHTML = `
        <span class="relative z-10">
          <i class="fas fa-spinner animate-spin"></i> Enviando...
        </span>
      `;

      submitBtn.disabled = true;

    const formData = new FormData(e.target);
    const formObject = Object.fromEntries(formData.entries());

    try {
      const response = await fetch('https://www.acarquitectura.com.co/api/send-email', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(formObject),
      });

      if (response.ok) {
        alert('Tu mensaje fue enviado correctamente.');
        e.target.reset();
      } else {
        alert('Hubo un error al enviar tu mensaje. Por favor, inténtalo nuevamente.');
      }
    } finally {
        submitBtn.innerHTML = `<span class="relative z-10">Enviar mensaje</span>`;
        submitBtn.disabled = false;
    }
  });
</script>